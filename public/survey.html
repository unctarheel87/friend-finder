<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Survey</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Compiled and minified CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-rc.2/css/materialize.min.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
    <a class="home-link" href='/'><i class="material-icons left">keyboard_backspace</i>Back to Home</a>
    <h3>Tell us about yourself!</h3>
  <section>
    <form id="survey-form">
      <div class="user-info">
        <div class="input-field col s12">
          <input placeholder="First Name" id="first_name" type="text" class="validate">
          <label for="first_name">First Name</label>
        </div>
        <div class="input-field col s12">
          <input placeholder="Photo" id="photo" type="text" class="validate">
          <label for="photo">Photo (URL)</label>
        </div>
      </div>
      <div class="survey">
        <div class="input-field col s12 card">
          <div class="card-content">
            <p>You are adventurous at heart, preferring to live life spontaneously - you're always open to new experiences.</p>
            <select id="q1">
              <option value="" disabled selected>Choose your option</option>
              <option value="1">Option 1 (Strongly Disagree)</option>
              <option value="2">Option 2</option>
              <option value="3">Option 3</option>
              <option value="4">Option 4</option>
              <option value="5">Option 5 (Strongly Agree)</option>
            </select>
            <label>Question 1</label>
          </div>
        </div>
        <div class="input-field col s12 card">
          <div class="card-content">
            <p>You find social gatherings invigorating, a consumate party-goer who makes friends at every opportunity.</p>
            <select id="q2">
              <option value="" disabled selected>Choose your option</option>
              <option value="1">Option 1 (Strongly Disagree)</option>
              <option value="2">Option 2</option>
              <option value="3">Option 3</option>
              <option value="4">Option 4</option>
              <option value="5">Option 5 (Strongly Agree)</option>
            </select>
            <label>Question 2</label>
          </div>
        </div>
        <div class="input-field col s12 card">
          <div class="card-content">
            <p>You prefer mind over matter, you can always be found engaging in thought-provoking, intellectual conversations.</p>
            <select id="q3">
              <option value="" disabled selected>Choose your option</option>
              <option value="1">Option 1 (Strongly Disagree)</option>
              <option value="2">Option 2</option>
              <option value="3">Option 3</option>
              <option value="4">Option 4</option>
              <option value="5">Option 5 (Strongly Agree)</option>
            </select>
            <label>Question 3</label>
          </div>
        </div>
        <div class="input-field col s12 card">
          <div class="card-content">
            <p>Competition drives you with a natural affinity for team activities and athletic endeavours; physical challenges motivate you and drive purpose.</p>
            <select id="q4">
              <option value="" disabled selected>Choose your option</option>
              <option value="1">Option 1 (Strongly Disagree)</option>
              <option value="2">Option 2</option>
              <option value="3">Option 3</option>
              <option value="4">Option 4</option>
              <option value="5">Option 5 (Strongly Agree)</option>
            </select>
            <label>Question 4</label>
          </div>
        </div>
        <div class="input-field col s12 card">
          <div class="card-content"> 
            <p>You're a hopeless romantic who appreciates the richness that comes with genuine, authentic relationships.</p>
            <select id="q5">
              <option value="" disabled selected>Choose your option</option>
              <option value="1">Option 1 (Strongly Disagree)</option>
              <option value="2">Option 2</option>
              <option value="3">Option 3</option>
              <option value="4">Option 4</option>
              <option value="5">Option 5 (Strongly Agree)</option>
            </select>
            <label>Question 5</label>
          </div>
        </div>
        <div class="input-field col s12 card">
          <div class="card-content">  
            <p>You are a natual leader, always driving headlong into the next great big idea. Others are natually drawn to your drive and charisma.</p>
            <select id="q6">
              <option value="" disabled selected>Choose your option</option>
              <option value="1">Option 1 (Strongly Disagree)</option>
              <option value="2">Option 2</option>
              <option value="3">Option 3</option>
              <option value="4">Option 4</option>
              <option value="5">Option 5 (Strongly Agree)</option>
            </select>
            <label>Question 6</label>
          </div>
        </div>
        <div class="input-field col s12 card">
          <div class="card-content">
            <p>A large crowd doesn't deter you, quite the opposite; you are a natural performer who's always chasing the next laugh or applause.</p>
            <select id="q7">
              <option value="" disabled selected>Choose your option</option>
              <option value="1">Option 1 (Strongly Disagree)</option>
              <option value="2">Option 2</option>
              <option value="3">Option 3</option>
              <option value="4">Option 4</option>
              <option value="5">Option 5 (Strongly Agree)</option>
            </select>
            <label>Question 7</label>
          </div>
        </div>
        <div class="input-field col s12 card">
          <div class="card-content">
            <p>You are serious and contemplative, a mysterious type who enjoys 1-on-1 conversations late into the night.</p>
            <select id="q8">
              <option value="" disabled selected>Choose your option</option>
              <option value="1">Option 1 (Strongly Disagree)</option>
              <option value="2">Option 2</option>
              <option value="3">Option 3</option>
              <option value="4">Option 4</option>
              <option value="5">Option 5 (Strongly Agree)</option>
            </select>
            <label>Question 8</label>
          </div>
        </div>
        <div class="input-field col s12 card">
          <div class="card-content">
            <p>A deeply spiritual being, you see beyond the temporal. Whether its a striking sunset or the somber passing of loved one, you're sensibilites are tethered to the unknown.</p>
            <select id="q9">
              <option value="" disabled selected>Choose your option</option>
              <option value="1">Option 1 (Strongly Disagree)</option>
              <option value="2">Option 2</option>
              <option value="3">Option 3</option>
              <option value="4">Option 4</option>
              <option value="5">Option 5 (Strongly Agree)</option>
            </select>
            <label>Question 9</label>
          </div>
        </div>
        <div class="input-field col s12 card">
          <div class="card-content">
            <p>You've got a keen eye for design and form. The traditional artsy type, you're always on the forefront of fashion and carry an undeniable sense of 'cool'.</p>
            <select id="q10">
              <option value="" disabled selected>Choose your option</option>
              <option value="1">Option 1 (Strongly Disagree)</option>
              <option value="2">Option 2</option>
              <option value="3">Option 3</option>
              <option value="4">Option 4</option>
              <option value="5">Option 5 (Strongly Agree)</option>
            </select>
            <label>Question 10</label>
          </div>
        </div>
        <button class="btn-large waves-effect waves-light" type="submit" id="survey-btn">Submit
            <i class="material-icons right">send</i>
        </button>
      </form>
    </div>
  </section>

   <!-- Modal Structure -->
   <div id="modal1" class="modal">
     <div class="modal-content">
        <h4>Your friend match is...</h4>
        <div class="progress">
          <div class="indeterminate"></div>
        </div>
     </div>
     <div class="modal-footer">
       <a href="#!" class="modal-close waves-effect waves-green btn-flat">Close</a>
     </div>
   </div>
   

<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-rc.2/js/materialize.min.js"></script>  
<script>
  $(document).ready(function(){
    //materialize components
    $('select').formSelect();
    $('.modal').modal();
    //form & api logic
    $('#survey-btn').on('click', function(e) {
      e.preventDefault();
      const surveyScores = []
      $("#survey-form select").each(function() {
        surveyScores.push(parseInt($(this).val()))
      });
      const surveyResults = { 
        "name": $('#first_name').val().trim(),
        "photo": $('#photo').val().trim(),
        "scores": surveyScores
      }
      const url = "/api/friends"
      $.post(url, surveyResults).done(function(data) {
        const apiData = data
        //clear modal
        $('.modal-content h3').remove()
        $('.modal-content img').remove()
        //show progress bar
        $('.modal').modal('open')
        $('.progress').show();
        setTimeout(function(apiData) {
          $('.progress').hide();
          const h3 = $('<h3>')
          const img = $('<img>')
          $('.modal-content').append(h3).append(img)
          h3.text(data.name)
          img.attr('src', data.photo)
        }, 3000)
      });
    })
  });
</script>
</body>
</html>